{% extends "core/mobile/base_mobile.html" %}
{% from "core/mobile/components/app_card.html" import render_app_card %}

{% block title %}ITCJ - Dashboard Staff{% endblock %}

{% block extra_css %}
<link rel="stylesheet"
    href="{{ url_for('static', filename='core/css/mobile/dashboard.css') }}?v={{ sv('core', 'css/mobile/dashboard.css') }}">
{% endblock %}

{% block content %}
<!-- Saludo -->
<div class="mobile-greeting">
    <h2 class="mobile-greeting-text">Hola, {{ user.first_name }}!</h2>
    <p class="mobile-greeting-sub">Dashboard ITCJ</p>
</div>

<!-- Tarjeta de info del staff -->
<div class="mobile-user-card">
    <div class="mobile-user-avatar staff">
        {{ user.first_name[:1]|upper }}{{ user.last_name[:1]|upper }}
    </div>
    <div class="mobile-user-info">
        <div class="mobile-user-name">{{ user.full_name }}</div>
        {% if user.get_position_title() %}
        <div class="mobile-user-detail">
            <i class="bi bi-briefcase"></i> {{ user.get_position_title() }}
        </div>
        {% endif %}
        {% set dept = user.get_current_department() %}
        {% if dept %}
        <div class="mobile-user-detail">
            <i class="bi bi-building"></i> {{ dept.name }}
        </div>
        {% endif %}
        {% if user.email %}
        <div class="mobile-user-detail">
            <i class="bi bi-envelope"></i> {{ user.email }}
        </div>
        {% endif %}
    </div>
</div>

<!-- Accesos rapidos -->
{% if quick_actions %}
<div class="mobile-section-title">
    <i class="bi bi-lightning"></i> Accesos Rapidos
</div>
<div class="mobile-quick-actions">
    {% for action in quick_actions %}
    <a href="{{ action.url }}" class="mobile-quick-action-btn">
        <i class="bi {{ action.icon }}"></i>
        <span>{{ action.label }}</span>
    </a>
    {% endfor %}
</div>
{% endif %}

<!-- Grid de aplicaciones -->
<div class="mobile-section-title">
    <i class="bi bi-grid-3x3-gap"></i> Aplicaciones
</div>

<div class="mobile-app-grid">
    {% for app in apps %}
    {{ render_app_card(app) }}
    {% else %}
    <div class="mobile-empty-state">
        <i class="bi bi-inbox"></i>
        <p>No tienes aplicaciones asignadas</p>
    </div>
    {% endfor %}
</div>
{% endblock %}
